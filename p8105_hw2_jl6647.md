p8105_hw2_jl6647
================
Jiatong LI
2023-09-27

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
library(dplyr)
```

## HW2 Problem 2

### Read and clean Mr. Trash Wheel’s data

- specify the sheet in the Excel file and to omit non-data entries (rows
  with notes / figures; columns containing notes) using arguments in
  read_excel
- use reasonable variable names
- omit rows that do not include dumpster-specific data

### Mr. Trash Wheel

``` r
trash_df = read_excel(
  "202207 Trash Wheel Collection Data.xlsx",
  range = "A2:N549",
  sheet = "Mr. Trash Wheel"
) |> 
  janitor::clean_names() |>
  mutate(year = as.integer(year)) |> 
  mutate(homes_powered = weight_tons*500/30) |> 
  mutate(wheel_type = "mr") |> 
  drop_na(dumpster)
```

### Professor Trash Wheel

``` r
professor_df = read_excel(
  "202207 Trash Wheel Collection Data.xlsx",
  sheet = "Professor Trash Wheel",
  range = "A2:M96"
) |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(homes_powered = weight_tons*500/30) |> 
  mutate(wheel_type = "professor")
```

### Gwynnda Trash Wheel

``` r
gwynnda_df = read_excel(
  "202207 Trash Wheel Collection Data.xlsx",
  sheet = "Gwynnda Trash Wheel",
  range = "A2:K109"
) |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(homes_powered = weight_tons*500/30) |> 
  mutate(wheel_type = "gwynnda")
```

### Combine datasets together

``` r
combined_dataset = bind_rows(trash_df,professor_df,gwynnda_df) |> 
                   relocate(wheel_type)
print(combined_dataset)
```

    ## # A tibble: 747 × 16
    ##    wheel_type dumpster month  year date                weight_tons
    ##    <chr>         <dbl> <chr> <dbl> <dttm>                    <dbl>
    ##  1 mr                1 May    2014 2014-05-16 00:00:00        4.31
    ##  2 mr                2 May    2014 2014-05-16 00:00:00        2.74
    ##  3 mr                3 May    2014 2014-05-16 00:00:00        3.45
    ##  4 mr                4 May    2014 2014-05-17 00:00:00        3.1 
    ##  5 mr                5 May    2014 2014-05-17 00:00:00        4.06
    ##  6 mr                6 May    2014 2014-05-20 00:00:00        2.71
    ##  7 mr                7 May    2014 2014-05-21 00:00:00        1.91
    ##  8 mr                8 May    2014 2014-05-28 00:00:00        3.7 
    ##  9 mr                9 June   2014 2014-06-05 00:00:00        2.52
    ## 10 mr               10 June   2014 2014-06-11 00:00:00        3.76
    ## # ℹ 737 more rows
    ## # ℹ 10 more variables: volume_cubic_yards <dbl>, plastic_bottles <dbl>,
    ## #   polystyrene <dbl>, cigarette_butts <dbl>, glass_bottles <dbl>,
    ## #   grocery_bags <dbl>, chip_bags <dbl>, sports_balls <dbl>,
    ## #   homes_powered <dbl>, plastic_bags <dbl>

### Describe the data

- Write a paragraph about these data; you are encouraged to use
  inline R. Be sure to note the number of observations in the resulting
  dataset, and give examples of key variables. For available data, what
  was the total weight of trash collected by Professor Trash Wheel? What
  was the total number of cigarette butts collected by Gwynnda in July
  of 2021?

The number of observations in the combined dataset: 747

The number of variables in the combined dataset: 16

Names of key variables: wheel_type, dumpster, month, year, date,
weight_tons, volume_cubic_yards, plastic_bottles, polystyrene,
cigarette_butts, glass_bottles, grocery_bags, chip_bags, sports_balls,
homes_powered, plastic_bags

Total weight of trash collected by Professor Trash Wheel: 190.12

Total number of cigarette butts collected by Gwynnda in July of 2021:
1.63^{4}

## HW2 Problem 3

### Import, clean, and tidy the dataset of baseline demographics

- Ensure that sex and APOE4 carrier status are appropriate encoded
  (i.e. not numeric)
- Remove any participants who do not meet the stated inclusion criteria
  (i.e. no MCI at baseline)

``` r
baseline_df = 
  read_csv("data_mci/MCI_baseline.csv",skip = 1) |> 
  janitor::clean_names() |> 
  mutate(
    sex = case_match(
      sex,
      1 ~ "Male",
      0 ~ "Female"),
    sex = as.factor(sex)) |> 
  mutate(
    apoe4 = case_match(
      apoe4,
      1 ~ "APOE4 Carrier",
      0 ~ "APOE4 Non-carrier"),
    apoe4 = as.factor(apoe4)) 
```

    ## Rows: 483 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Age at onset
    ## dbl (5): ID, Current Age, Sex, Education, apoe4
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
mci_baseline = 
  baseline_df |> 
  filter(age_at_onset != ".")
```

### Discuss important steps in the import process and relevant features of the dataset

- How many participants were recruited, and of these how many develop
  MCI?

483 participants were recruited.

97 develop MCI.

- What is the average baseline age?

The average baseline age is 65.6113402

- What proportion of women in the study are APOE4 carriers?

``` r
carrier_female = 
  mci_baseline |> 
  filter(sex == "Female" & apoe4 == "APOE4 Carrier") |> 
  count()
```

In the study, 0.3092784 is the proportion of women in the study are
APOE4 carriers

### Import, clean, and tidy the dataset of longitudinally observed biomarker values

    ## Rows: 487 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (5): Baseline, Time 2, Time 4, Time 6, Time 8
    ## dbl (1): Study ID
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
amy_df
```

    ## # A tibble: 485 × 6
    ##       id baseline    Time_2_years Time_4_years Time_6_years Time_8_years
    ##    <dbl> <chr>       <chr>        <chr>        <chr>        <chr>       
    ##  1     1 0.1105487   <NA>         0.109325197  0.104756131  0.107257697 
    ##  2     2 0.107481183 0.109157373  0.109457839  0.105729713  0.10661845  
    ##  3     3 0.106087034 0.108744509  0.106065035  <NA>         0.106152357 
    ##  4     4 0.109251358 0.108699686  0.110540386  0.107476797  0.111212209 
    ##  5     5 0.107950408 0.112273883  0.115139677  0.106606054  0.106052066 
    ##  6     6 0.112426974 0.112853415  0.11143945   0.110279277  0.114982747 
    ##  7     7 0.112246391 <NA>         0.104251905  0.112485583  0.112055612 
    ##  8     8 0.109563372 0.109470828  <NA>         0.108742168  0.110268552 
    ##  9     9 0.112101884 0.109781199  0.108832888  <NA>         <NA>        
    ## 10    10 0.1116094   0.111592149  <NA>         <NA>         0.110051296 
    ## # ℹ 475 more rows

### Comment on the steps on the import process and the features of the dataset

During the import process, data is imported from `mci_amyloid.csv` and
participants who have no MCI is removed from baseline column to avoid
invalid data. Variable names have been changed to make the data more
understandable. To better combine the two datasets of mci_amyloid and
mci_baseline, ‘study_id’ is changed.

487 participants were recruited.

485 participants observed biomarker values.

In the study, 0.7134021 is the proportion of participants who
successfully completed the whole process.

### Check whether some participants appear in only the baseline or amyloid datasets, and comment on your findings

There’re 3 participants appear in only the baseline datasets.

``` r
only_in_baseline_df
```

    ## # A tibble: 3 × 11
    ##      id current_age sex    education apoe4    age_at_onset baseline Time_2_years
    ##   <dbl>       <dbl> <fct>      <dbl> <fct>    <chr>        <chr>    <chr>       
    ## 1    14        58.4 Female        20 APOE4 N… 66.2         <NA>     <NA>        
    ## 2    49        64.7 Male          16 APOE4 N… 68.4         <NA>     <NA>        
    ## 3   268        61.4 Female        18 APOE4 C… 67.5         <NA>     <NA>        
    ## # ℹ 3 more variables: Time_4_years <chr>, Time_6_years <chr>,
    ## #   Time_8_years <chr>

There are 391 participants appear in only the amyloid datasets.

``` r
only_in_amy_df
```

    ## # A tibble: 391 × 11
    ##       id current_age sex   education apoe4 age_at_onset baseline    Time_2_years
    ##    <dbl>       <dbl> <fct>     <dbl> <fct> <chr>        <chr>       <chr>       
    ##  1     1          NA <NA>         NA <NA>  <NA>         0.1105487   <NA>        
    ##  2     2          NA <NA>         NA <NA>  <NA>         0.107481183 0.109157373 
    ##  3     4          NA <NA>         NA <NA>  <NA>         0.109251358 0.108699686 
    ##  4     6          NA <NA>         NA <NA>  <NA>         0.112426974 0.112853415 
    ##  5     8          NA <NA>         NA <NA>  <NA>         0.109563372 0.109470828 
    ##  6     9          NA <NA>         NA <NA>  <NA>         0.112101884 0.109781199 
    ##  7    10          NA <NA>         NA <NA>  <NA>         0.1116094   0.111592149 
    ##  8    11          NA <NA>         NA <NA>  <NA>         0.109119335 0.109316496 
    ##  9    12          NA <NA>         NA <NA>  <NA>         0.112042298 0.114167481 
    ## 10    15          NA <NA>         NA <NA>  <NA>         0.111544948 <NA>        
    ## # ℹ 381 more rows
    ## # ℹ 3 more variables: Time_4_years <chr>, Time_6_years <chr>,
    ## #   Time_8_years <chr>

### Combine the demographic and biomarker datasets so that only participants who appear in both datasets are retained, and briefly describe the resulting dataset

As seen in the datasets below, after combination, 94 participants appear
in both two datasets, and only 66 participants successfully went through
the whole process.

``` r
both_have_df
```

    ## # A tibble: 94 × 11
    ##       id current_age sex    education apoe4   age_at_onset baseline Time_2_years
    ##    <dbl>       <dbl> <fct>      <dbl> <fct>   <chr>        <chr>    <chr>       
    ##  1     3        62.5 Male          16 APOE4 … 66.8         0.10608… 0.108744509 
    ##  2     5        66   Male          16 APOE4 … 68.7         0.10795… 0.112273883 
    ##  3     7        66.5 Male          18 APOE4 … 74           0.11224… <NA>        
    ##  4    13        63.1 Male          12 APOE4 … 69           0.11030… 0.108534417 
    ##  5    18        67.8 Male          16 APOE4 … 69.8         0.11413… 0.107093264 
    ##  6    22        67.3 Female        20 APOE4 … 74.6         0.10932… <NA>        
    ##  7    26        64.8 Female        20 APOE4 … 71.1         0.10474… 0.110171403 
    ##  8    30        66.3 Female        12 APOE4 … 73.1         0.10931… 0.111327152 
    ##  9    39        68.3 Female        16 APOE4 … 70.2         0.10442… <NA>        
    ## 10    43        67.1 Female        16 APOE4 … 71.6         0.11042… 0.105244566 
    ## # ℹ 84 more rows
    ## # ℹ 3 more variables: Time_4_years <chr>, Time_6_years <chr>,
    ## #   Time_8_years <chr>

``` r
whole_process_df
```

    ## # A tibble: 66 × 11
    ##       id current_age sex    education apoe4   age_at_onset baseline Time_2_years
    ##    <dbl>       <dbl> <fct>      <dbl> <fct>   <chr>        <chr>    <chr>       
    ##  1     5        66   Male          16 APOE4 … 68.7         0.10795… 0.112273883 
    ##  2    13        63.1 Male          12 APOE4 … 69           0.11030… 0.108534417 
    ##  3    18        67.8 Male          16 APOE4 … 69.8         0.11413… 0.107093264 
    ##  4    26        64.8 Female        20 APOE4 … 71.1         0.10474… 0.110171403 
    ##  5    30        66.3 Female        12 APOE4 … 73.1         0.10931… 0.111327152 
    ##  6    45        62.9 Male          20 APOE4 … 65.2         0.10688… 0.110818579 
    ##  7    55        69.3 Female        16 APOE4 … 73.6         0.10150… 0.105455229 
    ##  8    59        66.7 Female        20 APOE4 … 74.4         0.10341… 0.10351346  
    ##  9    65        62.8 Female        16 APOE4 … 66.5         0.11256… 0.11366025  
    ## 10    69        65.5 Female        20 APOE4 … 72.5         0.11439… 0.104970251 
    ## # ℹ 56 more rows
    ## # ℹ 3 more variables: Time_4_years <chr>, Time_6_years <chr>,
    ## #   Time_8_years <chr>

### Export the result as a CSV to your data directory

``` r
write_csv(both_have_df,"Participants appear in both mci_amyloid and mci_baseline datasets")
write_csv(whole_process_df,"Participants appear in both datasets and went through the whole process")
```
